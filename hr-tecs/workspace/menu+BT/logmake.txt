touch -r kernel_cfg.c kernel_cfg.timestamp
../../../mruby/bin/mrbc.exe -BrDomainEV3_Mruby_MrubyVM_irep -orDomainEV3_Mruby_MrubyVM_mrb.c ../../mruby_lib/EV3_common.rb ../../mruby_lib/RTOS.rb ../../mruby_lib/Button.rb ../../mruby_lib/LCD.rb ../../mruby_lib/FatFile.rb ../../mruby_lib/FatDir.rb ../mruby_app/parameter.rb ../mruby_app/parameter_etrobo.rb ../mruby_app/menu_sample_withFileClass.rb 

touch omit_svc.h
rm -f libkernel.a
arm-none-eabi-ar -rcs libkernel.a  chip_support.o core_support.o dataqueue_mod.o target_config.o target_serial.o chip_config.o chip_timer.o core_config.o arm.o svc_table.o startup.o task.o wait.o memory.o time_event.o task_manage.o task_refer.o task_sync.o task_except.o semaphore.o eventflag.o dataqueue.o pridataq.o mutex.o mempfix.o time_manage.o cyclic.o alarm.o overrun.o sys_manage.o mem_manage.o interrupt.o exception.o 
arm-none-eabi-ranlib libkernel.a
arm-none-eabi-gcc -std=gnu99 -D_GNU_SOURCE -Dgcc -Dam1808 -DDMA_MODE -mcpu=arm926ej-s -mlittle-endian -DUSE_CFG_PASS3 -g -Wall -O2 -DBUILD_EV3_PLATFORM -DOMIT_INITIALIZE_SECTIONS -DCONFIG_FB_DEFERRED_IO -D__KERNEL__ -D__TARGET_ARCH_ARM=5 -I. -I./gen -I../../tecs_kernel -I../../include -I../../arch -I../.. -I../../target/ev3_gcc/api/src -I../../../mruby/include -I../../tecs_lib/mindstorms_ev3 -I../../tecs_lib/common -I../../tecsgen/tecsgen/tecs -I../../tecsgen/tecsgen/tecs/mruby -I../../tecsgen/tecsgen/tecs/TLSFMalloc -I../../tecsgen/tecsgen/tecs/posix -I../../tecs_lib/mindstorms_ev3/balancer  -I../../target/ev3_gcc/drivers -I../../modules/btstack/platforms/ev3rt -I../../target/ev3_gcc/drivers/soc//AM1808_StarterWare_1_00_03_03/include/hw -I../../modules/usblib/usblib/include -I../../target/ev3_gcc -I../../target/ev3_gcc/api/include -I../../target/ev3_gcc/dmloader/app/include -I../../target/ev3_gcc/dmloader/include -I../../target/ev3_gcc/drivers/bluetooth/btstack/include -I../../target/ev3_gcc/drivers/bluetooth/include -I../../target/ev3_gcc/drivers/brick/include -I../../target/ev3_gcc/drivers/common/include -I../../target/ev3_gcc/drivers/common/virtual-linux-kernel/arch/arm/include -I../../target/ev3_gcc/drivers/common/virtual-linux-kernel/include -I../../target/ev3_gcc/drivers/console/include -I../../target/ev3_gcc/drivers/fatfs/include -I../../target/ev3_gcc/drivers/gpio/include -I../../target/ev3_gcc/drivers/lcd/include -I../../target/ev3_gcc/drivers/lcd/linux/include -I../../target/ev3_gcc/drivers/linux/arch/arm/include -I../../target/ev3_gcc/drivers/linux/arch/arm/mach-davinci/include -I../../target/ev3_gcc/drivers/linux/include -I../../target/ev3_gcc/drivers/mbed/include -I../../target/ev3_gcc/drivers/motor/include -I../../target/ev3_gcc/drivers/newlib/include -I../../target/ev3_gcc/drivers/sensor/analog/include -I../../target/ev3_gcc/drivers/sensor/i2c/include -I../../target/ev3_gcc/drivers/sensor/uart/d_uart/Linuxmod_AM1808/pru-firmware-05-31-2011-1423-v3.0/pru/hal/common/include -I../../target/ev3_gcc/drivers/sensor/uart/d_uart/Linuxmod_AM1808/pru-firmware-05-31-2011-1423-v3.0/pru/hal/uart/include -I../../target/ev3_gcc/drivers/sensor/uart/include -I../../target/ev3_gcc/drivers/soc/AM1808_StarterWare_1_00_03_03/include -I../../target/ev3_gcc/drivers/soc/include -I../../target/ev3_gcc/drivers/sound/include -I../../target/ev3_gcc/drivers/usbmsc/include -I../../target/ev3_gcc/kernel_mod/include -I../../target/ev3_gcc/pil/include -I../../target/ev3_gcc/platform/include -I../../target/ev3_gcc/TLSF-2.4.6/include -I../../arch/arm_gcc/am1808 -I../../arch/arm_gcc/common -I../../arch/gcc -I../../target/ev3_gcc/api -I../../target/ev3_gcc/drivers/fatfs/ff10b/src -I./../common -I. -I./zmodem/include  -L../../modules/btstack/platforms/ev3rt -L../../modules/usblib/Release -mcpu=arm926ej-s -nostdlib -mlittle-endian -N -L ../../../mruby/build/ARM/lib/ -Wl,-Ttext,0xC0008000 -Wl,-Tdata,0xC0108000 -T cfg2_out.ld  -o cfg2_out start.o  \
		 ev3main.o tlsf.o target_serial_dbsio.o driver_debug.o ev3_hacks.o hires_cyclic.o hires_alarm.o bluetooth_dri.o brick_dri.o ev3cyclic_dri.o console_dri.o console_menu.o fatfs_dri.o diskio.o fatfs_syscall.o ff.o mmcsd.o mmcsdlib.o mmcsd_dri.o mmcsd_proto.o mmcsd_rw.o unicode.o gpio_dri.o lcd_dri.o lcd_font.o lcd_spi.o newlib_dri.o analog_dri.o uart_dri.o pru.o suart_utils.o suart_api.o pru_suart.o i2c_dri.o davinci_iic_dri.o soc_cache.o soc_edma.o soc_interrupt.o edma.o uart.o cp15.o psc.o spi.o usb.o usbphyGS60.o cppi41dma.o evmAM1808_usb.o sound_dri.o motor_dri.o usbmsc_dri.o usbmsc_media_functions.o usb_dev_msc.o usb_msc_structs.o driver_interface_brick.o driver_interface_bluetooth.o driver_interface_filesys.o driver_interface_sound.o ev3exception.o ev3rt_config.o minIni.o ev3api.o ev3api_cfg.o ev3api_battery.o ev3api_brick.o ev3api_fs.o ev3api_speaker.o ev3api_lcd.o ev3api_motor.o ev3api_newlib.o ev3api_sensor.o vasyslog.o tTask_rDomainEV3_tecsgen.o tKernel_rDomainEV3_tecsgen.o tTLSFMalloc_rDomainEV3_tecsgen.o tUltrasonicSensor_rDomainEV3_tecsgen.o tColorSensor_rDomainEV3_tecsgen.o tTouchSensor_rDomainEV3_tecsgen.o tGyroSensor_rDomainEV3_tecsgen.o tMotor_rDomainEV3_tecsgen.o tButton_rDomainEV3_tecsgen.o tLCD_rDomainEV3_tecsgen.o tLED_rDomainEV3_tecsgen.o tBattery_rDomainEV3_tecsgen.o tSpeaker_rDomainEV3_tecsgen.o tEV3Platform_rDomainEV3_tecsgen.o tBalancer_rDomainEV3_tecsgen.o tSharedMemory_rDomainEV3_tecsgen.o tRunApp_rDomainEV3_tecsgen.o nMruby_tMrubyVM_rDomainEV3_tecsgen.o nMruby_tMrubyTaskBody_rDomainEV3_tecsgen.o  nMruby_tTECSInitializer_tecsgen.o nMruby_tCharPointer_tecsgen.o nMruby_tInt8Pointer_tecsgen.o nMruby_tInt32Pointer_tecsgen.o nMruby_tUInt16Pointer_tecsgen.o nMruby_tIntPointer_tecsgen.o nMruby_tULongPointer_tecsgen.o   nMruby_tsKernel_rDomainEV3_tecsgen.o nMruby_tsMotor_rDomainEV3_tecsgen.o nMruby_tsLCD_rDomainEV3_tecsgen.o nMruby_tsLED_rDomainEV3_tecsgen.o nMruby_tsButton_rDomainEV3_tecsgen.o nMruby_tsBattery_rDomainEV3_tecsgen.o nMruby_tsSpeaker_rDomainEV3_tecsgen.o nMruby_tsUltrasonicSensor_rDomainEV3_tecsgen.o nMruby_tsGyroSensor_rDomainEV3_tecsgen.o nMruby_tsColorSensor_rDomainEV3_tecsgen.o nMruby_tsTouchSensor_rDomainEV3_tecsgen.o nMruby_tsBalancer_rDomainEV3_tecsgen.o nMruby_tsSharedMemory_rDomainEV3_tecsgen.o nMruby_tsRunApp_rDomainEV3_tecsgen.o nMruby_tsKernel.o nMruby_tsMotor.o nMruby_tsLCD.o nMruby_tsLED.o nMruby_tsButton.o nMruby_tsBattery.o nMruby_tsSpeaker.o nMruby_tsUltrasonicSensor.o nMruby_tsGyroSensor.o nMruby_tsColorSensor.o nMruby_tsTouchSensor.o nMruby_tsBalancer.o nMruby_tsSharedMemory.o nMruby_tsRunApp.o  nMruby_tsKernel_Initializer_tecsgen.o nMruby_tsMotor_Initializer_tecsgen.o nMruby_tsLCD_Initializer_tecsgen.o nMruby_tsLED_Initializer_tecsgen.o nMruby_tsButton_Initializer_tecsgen.o nMruby_tsBattery_Initializer_tecsgen.o nMruby_tsSpeaker_Initializer_tecsgen.o nMruby_tsUltrasonicSensor_Initializer_tecsgen.o nMruby_tsGyroSensor_Initializer_tecsgen.o nMruby_tsColorSensor_Initializer_tecsgen.o nMruby_tsTouchSensor_Initializer_tecsgen.o nMruby_tsBalancer_Initializer_tecsgen.o nMruby_tsSharedMemory_Initializer_tecsgen.o nMruby_tsRunApp_Initializer_tecsgen.o nMruby_tsKernel_Initializer.o nMruby_tsMotor_Initializer.o nMruby_tsLCD_Initializer.o nMruby_tsLED_Initializer.o nMruby_tsButton_Initializer.o nMruby_tsBattery_Initializer.o nMruby_tsSpeaker_Initializer.o nMruby_tsUltrasonicSensor_Initializer.o nMruby_tsGyroSensor_Initializer.o nMruby_tsColorSensor_Initializer.o nMruby_tsTouchSensor_Initializer.o nMruby_tsBalancer_Initializer.o nMruby_tsSharedMemory_Initializer.o nMruby_tsRunApp_Initializer.o   tTask.o tUltrasonicSensor.o tColorSensor.o tTouchSensor.o tGyroSensor.o tMotor.o tButton.o tLCD.o tLED.o tBattery.o tSpeaker.o tEV3Platform.o tBalancer.o tSharedMemory.o tRunApp.o nMruby_tMrubyVM.o nMruby_tMrubyTaskBody.o  nMruby_tTECSInitializer.o nMruby_tCharPointer.o nMruby_tInt8Pointer.o nMruby_tInt32Pointer.o nMruby_tUInt16Pointer.o nMruby_tIntPointer.o nMruby_tULongPointer.o   balancer.o balancer_param.o rDomainEV3_Mruby_MrubyVM_mrb.o tecs_init.o log_output.o t_perror.o strerror.o   ../../../mruby/build/ARM/lib/libmruby.a -lm  serial_mod.o tl16c550.o banner.o syslog.o serial.o logtask.o   kernel_cfg.o kernel_mem2.o  -lBTstack -lusblib   libkernel.a -lc -lm -lgcc   
arm-none-eabi-nm -n cfg2_out > cfg2_out.syms
arm-none-eabi-objcopy -O srec -S cfg2_out cfg2_out.srec
rm -f cfg3_out.ld
../../cfg/cfg/cfg --pass 3 --kernel hrp2 -I. -I./gen -I../../tecs_kernel -I../../include -I../../arch -I../.. -I../../target/ev3_gcc/api/src -I../../../mruby/include -I../../tecs_lib/mindstorms_ev3 -I../../tecs_lib/common -I../../tecsgen/tecsgen/tecs -I../../tecsgen/tecsgen/tecs/mruby -I../../tecsgen/tecsgen/tecs/TLSFMalloc -I../../tecsgen/tecsgen/tecs/posix -I../../tecs_lib/mindstorms_ev3/balancer  -I../../target/ev3_gcc/drivers -I../../modules/btstack/platforms/ev3rt -I../../target/ev3_gcc/drivers/soc//AM1808_StarterWare_1_00_03_03/include/hw -I../../modules/usblib/usblib/include -I../../target/ev3_gcc -I../../target/ev3_gcc/api/include -I../../target/ev3_gcc/dmloader/app/include -I../../target/ev3_gcc/dmloader/include -I../../target/ev3_gcc/drivers/bluetooth/btstack/include -I../../target/ev3_gcc/drivers/bluetooth/include -I../../target/ev3_gcc/drivers/brick/include -I../../target/ev3_gcc/drivers/common/include -I../../target/ev3_gcc/drivers/common/virtual-linux-kernel/arch/arm/include -I../../target/ev3_gcc/drivers/common/virtual-linux-kernel/include -I../../target/ev3_gcc/drivers/console/include -I../../target/ev3_gcc/drivers/fatfs/include -I../../target/ev3_gcc/drivers/gpio/include -I../../target/ev3_gcc/drivers/lcd/include -I../../target/ev3_gcc/drivers/lcd/linux/include -I../../target/ev3_gcc/drivers/linux/arch/arm/include -I../../target/ev3_gcc/drivers/linux/arch/arm/mach-davinci/include -I../../target/ev3_gcc/drivers/linux/include -I../../target/ev3_gcc/drivers/mbed/include -I../../target/ev3_gcc/drivers/motor/include -I../../target/ev3_gcc/drivers/newlib/include -I../../target/ev3_gcc/drivers/sensor/analog/include -I../../target/ev3_gcc/drivers/sensor/i2c/include -I../../target/ev3_gcc/drivers/sensor/uart/d_uart/Linuxmod_AM1808/pru-firmware-05-31-2011-1423-v3.0/pru/hal/common/include -I../../target/ev3_gcc/drivers/sensor/uart/d_uart/Linuxmod_AM1808/pru-firmware-05-31-2011-1423-v3.0/pru/hal/uart/include -I../../target/ev3_gcc/drivers/sensor/uart/include -I../../target/ev3_gcc/drivers/soc/AM1808_StarterWare_1_00_03_03/include -I../../target/ev3_gcc/drivers/soc/include -I../../target/ev3_gcc/drivers/sound/include -I../../target/ev3_gcc/drivers/usbmsc/include -I../../target/ev3_gcc/kernel_mod/include -I../../target/ev3_gcc/pil/include -I../../target/ev3_gcc/platform/include -I../../target/ev3_gcc/TLSF-2.4.6/include -I../../arch/arm_gcc/am1808 -I../../arch/arm_gcc/common -I../../arch/gcc -I../../target/ev3_gcc/api -I../../target/ev3_gcc/drivers/fatfs/ff10b/src -I./../common -I. -I./zmodem/include \
			--rom-image cfg2_out.srec --symbol-table cfg2_out.syms \
			-T ../../target/ev3_gcc/target_opt.tf --api-table ../../kernel/kernel_api.csv --cfg1-def-table ../../kernel/kernel_def.csv  --cfg1-def-table ../../arch/arm_gcc/am1808/chip_def.csv  --cfg1-def-table ../../arch/arm_gcc/common/core_def.csv --api-table ../../target/ev3_gcc/api/ev3api.csv tEV3Sample.cfg

if ! [ -f cfg3_out.ld ]; then \
	sed "s/kernel_mem2\.o/kernel_mem3\.o/g" < cfg2_out.ld \
												> cfg3_out.ld; \
fi
arm-none-eabi-gcc -std=gnu99 -D_GNU_SOURCE -Dgcc -Dam1808 -DDMA_MODE -mcpu=arm926ej-s -mlittle-endian -DUSE_CFG_PASS3 -g -Wall -O2 -DBUILD_EV3_PLATFORM -DOMIT_INITIALIZE_SECTIONS -DCONFIG_FB_DEFERRED_IO -D__KERNEL__ -D__TARGET_ARCH_ARM=5 -I. -I./gen -I../../tecs_kernel -I../../include -I../../arch -I../.. -I../../target/ev3_gcc/api/src -I../../../mruby/include -I../../tecs_lib/mindstorms_ev3 -I../../tecs_lib/common -I../../tecsgen/tecsgen/tecs -I../../tecsgen/tecsgen/tecs/mruby -I../../tecsgen/tecsgen/tecs/TLSFMalloc -I../../tecsgen/tecsgen/tecs/posix -I../../tecs_lib/mindstorms_ev3/balancer  -I../../target/ev3_gcc/drivers -I../../modules/btstack/platforms/ev3rt -I../../target/ev3_gcc/drivers/soc//AM1808_StarterWare_1_00_03_03/include/hw -I../../modules/usblib/usblib/include -I../../target/ev3_gcc -I../../target/ev3_gcc/api/include -I../../target/ev3_gcc/dmloader/app/include -I../../target/ev3_gcc/dmloader/include -I../../target/ev3_gcc/drivers/bluetooth/btstack/include -I../../target/ev3_gcc/drivers/bluetooth/include -I../../target/ev3_gcc/drivers/brick/include -I../../target/ev3_gcc/drivers/common/include -I../../target/ev3_gcc/drivers/common/virtual-linux-kernel/arch/arm/include -I../../target/ev3_gcc/drivers/common/virtual-linux-kernel/include -I../../target/ev3_gcc/drivers/console/include -I../../target/ev3_gcc/drivers/fatfs/include -I../../target/ev3_gcc/drivers/gpio/include -I../../target/ev3_gcc/drivers/lcd/include -I../../target/ev3_gcc/drivers/lcd/linux/include -I../../target/ev3_gcc/drivers/linux/arch/arm/include -I../../target/ev3_gcc/drivers/linux/arch/arm/mach-davinci/include -I../../target/ev3_gcc/drivers/linux/include -I../../target/ev3_gcc/drivers/mbed/include -I../../target/ev3_gcc/drivers/motor/include -I../../target/ev3_gcc/drivers/newlib/include -I../../target/ev3_gcc/drivers/sensor/analog/include -I../../target/ev3_gcc/drivers/sensor/i2c/include -I../../target/ev3_gcc/drivers/sensor/uart/d_uart/Linuxmod_AM1808/pru-firmware-05-31-2011-1423-v3.0/pru/hal/common/include -I../../target/ev3_gcc/drivers/sensor/uart/d_uart/Linuxmod_AM1808/pru-firmware-05-31-2011-1423-v3.0/pru/hal/uart/include -I../../target/ev3_gcc/drivers/sensor/uart/include -I../../target/ev3_gcc/drivers/soc/AM1808_StarterWare_1_00_03_03/include -I../../target/ev3_gcc/drivers/soc/include -I../../target/ev3_gcc/drivers/sound/include -I../../target/ev3_gcc/drivers/usbmsc/include -I../../target/ev3_gcc/kernel_mod/include -I../../target/ev3_gcc/pil/include -I../../target/ev3_gcc/platform/include -I../../target/ev3_gcc/TLSF-2.4.6/include -I../../arch/arm_gcc/am1808 -I../../arch/arm_gcc/common -I../../arch/gcc -I../../target/ev3_gcc/api -I../../target/ev3_gcc/drivers/fatfs/ff10b/src -I./../common -I. -I./zmodem/include  -L../../modules/btstack/platforms/ev3rt -L../../modules/usblib/Release -mcpu=arm926ej-s -nostdlib -mlittle-endian -N -L ../../../mruby/build/ARM/lib/ -Wl,-Ttext,0xC0008000 -Wl,-Tdata,0xC0108000 -T cfg3_out.ld -o cfg3_out start.o \
		 ev3main.o tlsf.o target_serial_dbsio.o driver_debug.o ev3_hacks.o hires_cyclic.o hires_alarm.o bluetooth_dri.o brick_dri.o ev3cyclic_dri.o console_dri.o console_menu.o fatfs_dri.o diskio.o fatfs_syscall.o ff.o mmcsd.o mmcsdlib.o mmcsd_dri.o mmcsd_proto.o mmcsd_rw.o unicode.o gpio_dri.o lcd_dri.o lcd_font.o lcd_spi.o newlib_dri.o analog_dri.o uart_dri.o pru.o suart_utils.o suart_api.o pru_suart.o i2c_dri.o davinci_iic_dri.o soc_cache.o soc_edma.o soc_interrupt.o edma.o uart.o cp15.o psc.o spi.o usb.o usbphyGS60.o cppi41dma.o evmAM1808_usb.o sound_dri.o motor_dri.o usbmsc_dri.o usbmsc_media_functions.o usb_dev_msc.o usb_msc_structs.o driver_interface_brick.o driver_interface_bluetooth.o driver_interface_filesys.o driver_interface_sound.o ev3exception.o ev3rt_config.o minIni.o ev3api.o ev3api_cfg.o ev3api_battery.o ev3api_brick.o ev3api_fs.o ev3api_speaker.o ev3api_lcd.o ev3api_motor.o ev3api_newlib.o ev3api_sensor.o vasyslog.o tTask_rDomainEV3_tecsgen.o tKernel_rDomainEV3_tecsgen.o tTLSFMalloc_rDomainEV3_tecsgen.o tUltrasonicSensor_rDomainEV3_tecsgen.o tColorSensor_rDomainEV3_tecsgen.o tTouchSensor_rDomainEV3_tecsgen.o tGyroSensor_rDomainEV3_tecsgen.o tMotor_rDomainEV3_tecsgen.o tButton_rDomainEV3_tecsgen.o tLCD_rDomainEV3_tecsgen.o tLED_rDomainEV3_tecsgen.o tBattery_rDomainEV3_tecsgen.o tSpeaker_rDomainEV3_tecsgen.o tEV3Platform_rDomainEV3_tecsgen.o tBalancer_rDomainEV3_tecsgen.o tSharedMemory_rDomainEV3_tecsgen.o tRunApp_rDomainEV3_tecsgen.o nMruby_tMrubyVM_rDomainEV3_tecsgen.o nMruby_tMrubyTaskBody_rDomainEV3_tecsgen.o  nMruby_tTECSInitializer_tecsgen.o nMruby_tCharPointer_tecsgen.o nMruby_tInt8Pointer_tecsgen.o nMruby_tInt32Pointer_tecsgen.o nMruby_tUInt16Pointer_tecsgen.o nMruby_tIntPointer_tecsgen.o nMruby_tULongPointer_tecsgen.o   nMruby_tsKernel_rDomainEV3_tecsgen.o nMruby_tsMotor_rDomainEV3_tecsgen.o nMruby_tsLCD_rDomainEV3_tecsgen.o nMruby_tsLED_rDomainEV3_tecsgen.o nMruby_tsButton_rDomainEV3_tecsgen.o nMruby_tsBattery_rDomainEV3_tecsgen.o nMruby_tsSpeaker_rDomainEV3_tecsgen.o nMruby_tsUltrasonicSensor_rDomainEV3_tecsgen.o nMruby_tsGyroSensor_rDomainEV3_tecsgen.o nMruby_tsColorSensor_rDomainEV3_tecsgen.o nMruby_tsTouchSensor_rDomainEV3_tecsgen.o nMruby_tsBalancer_rDomainEV3_tecsgen.o nMruby_tsSharedMemory_rDomainEV3_tecsgen.o nMruby_tsRunApp_rDomainEV3_tecsgen.o nMruby_tsKernel.o nMruby_tsMotor.o nMruby_tsLCD.o nMruby_tsLED.o nMruby_tsButton.o nMruby_tsBattery.o nMruby_tsSpeaker.o nMruby_tsUltrasonicSensor.o nMruby_tsGyroSensor.o nMruby_tsColorSensor.o nMruby_tsTouchSensor.o nMruby_tsBalancer.o nMruby_tsSharedMemory.o nMruby_tsRunApp.o  nMruby_tsKernel_Initializer_tecsgen.o nMruby_tsMotor_Initializer_tecsgen.o nMruby_tsLCD_Initializer_tecsgen.o nMruby_tsLED_Initializer_tecsgen.o nMruby_tsButton_Initializer_tecsgen.o nMruby_tsBattery_Initializer_tecsgen.o nMruby_tsSpeaker_Initializer_tecsgen.o nMruby_tsUltrasonicSensor_Initializer_tecsgen.o nMruby_tsGyroSensor_Initializer_tecsgen.o nMruby_tsColorSensor_Initializer_tecsgen.o nMruby_tsTouchSensor_Initializer_tecsgen.o nMruby_tsBalancer_Initializer_tecsgen.o nMruby_tsSharedMemory_Initializer_tecsgen.o nMruby_tsRunApp_Initializer_tecsgen.o nMruby_tsKernel_Initializer.o nMruby_tsMotor_Initializer.o nMruby_tsLCD_Initializer.o nMruby_tsLED_Initializer.o nMruby_tsButton_Initializer.o nMruby_tsBattery_Initializer.o nMruby_tsSpeaker_Initializer.o nMruby_tsUltrasonicSensor_Initializer.o nMruby_tsGyroSensor_Initializer.o nMruby_tsColorSensor_Initializer.o nMruby_tsTouchSensor_Initializer.o nMruby_tsBalancer_Initializer.o nMruby_tsSharedMemory_Initializer.o nMruby_tsRunApp_Initializer.o   tTask.o tUltrasonicSensor.o tColorSensor.o tTouchSensor.o tGyroSensor.o tMotor.o tButton.o tLCD.o tLED.o tBattery.o tSpeaker.o tEV3Platform.o tBalancer.o tSharedMemory.o tRunApp.o nMruby_tMrubyVM.o nMruby_tMrubyTaskBody.o  nMruby_tTECSInitializer.o nMruby_tCharPointer.o nMruby_tInt8Pointer.o nMruby_tInt32Pointer.o nMruby_tUInt16Pointer.o nMruby_tIntPointer.o nMruby_tULongPointer.o   balancer.o balancer_param.o rDomainEV3_Mruby_MrubyVM_mrb.o tecs_init.o log_output.o t_perror.o strerror.o   ../../../mruby/build/ARM/lib/libmruby.a -lm  serial_mod.o tl16c550.o banner.o syslog.o serial.o logtask.o   kernel_cfg.o kernel_mem3.o  -lBTstack -lusblib   libkernel.a -lc -lm -lgcc  -lm 
arm-none-eabi-nm -n cfg3_out > cfg3_out.syms
arm-none-eabi-objcopy -O srec -S cfg3_out cfg3_out.srec
rm -f ldscript.ld
../../cfg/cfg/cfg --pass 4 --kernel hrp2 -I. -I./gen -I../../tecs_kernel -I../../include -I../../arch -I../.. -I../../target/ev3_gcc/api/src -I../../../mruby/include -I../../tecs_lib/mindstorms_ev3 -I../../tecs_lib/common -I../../tecsgen/tecsgen/tecs -I../../tecsgen/tecsgen/tecs/mruby -I../../tecsgen/tecsgen/tecs/TLSFMalloc -I../../tecsgen/tecsgen/tecs/posix -I../../tecs_lib/mindstorms_ev3/balancer  -I../../target/ev3_gcc/drivers -I../../modules/btstack/platforms/ev3rt -I../../target/ev3_gcc/drivers/soc//AM1808_StarterWare_1_00_03_03/include/hw -I../../modules/usblib/usblib/include -I../../target/ev3_gcc -I../../target/ev3_gcc/api/include -I../../target/ev3_gcc/dmloader/app/include -I../../target/ev3_gcc/dmloader/include -I../../target/ev3_gcc/drivers/bluetooth/btstack/include -I../../target/ev3_gcc/drivers/bluetooth/include -I../../target/ev3_gcc/drivers/brick/include -I../../target/ev3_gcc/drivers/common/include -I../../target/ev3_gcc/drivers/common/virtual-linux-kernel/arch/arm/include -I../../target/ev3_gcc/drivers/common/virtual-linux-kernel/include -I../../target/ev3_gcc/drivers/console/include -I../../target/ev3_gcc/drivers/fatfs/include -I../../target/ev3_gcc/drivers/gpio/include -I../../target/ev3_gcc/drivers/lcd/include -I../../target/ev3_gcc/drivers/lcd/linux/include -I../../target/ev3_gcc/drivers/linux/arch/arm/include -I../../target/ev3_gcc/drivers/linux/arch/arm/mach-davinci/include -I../../target/ev3_gcc/drivers/linux/include -I../../target/ev3_gcc/drivers/mbed/include -I../../target/ev3_gcc/drivers/motor/include -I../../target/ev3_gcc/drivers/newlib/include -I../../target/ev3_gcc/drivers/sensor/analog/include -I../../target/ev3_gcc/drivers/sensor/i2c/include -I../../target/ev3_gcc/drivers/sensor/uart/d_uart/Linuxmod_AM1808/pru-firmware-05-31-2011-1423-v3.0/pru/hal/common/include -I../../target/ev3_gcc/drivers/sensor/uart/d_uart/Linuxmod_AM1808/pru-firmware-05-31-2011-1423-v3.0/pru/hal/uart/include -I../../target/ev3_gcc/drivers/sensor/uart/include -I../../target/ev3_gcc/drivers/soc/AM1808_StarterWare_1_00_03_03/include -I../../target/ev3_gcc/drivers/soc/include -I../../target/ev3_gcc/drivers/sound/include -I../../target/ev3_gcc/drivers/usbmsc/include -I../../target/ev3_gcc/kernel_mod/include -I../../target/ev3_gcc/pil/include -I../../target/ev3_gcc/platform/include -I../../target/ev3_gcc/TLSF-2.4.6/include -I../../arch/arm_gcc/am1808 -I../../arch/arm_gcc/common -I../../arch/gcc -I../../target/ev3_gcc/api -I../../target/ev3_gcc/drivers/fatfs/ff10b/src -I./../common -I. -I./zmodem/include \
			--rom-image cfg3_out.srec --symbol-table cfg3_out.syms \
			-T ../../target/ev3_gcc/target_mem.tf --api-table ../../kernel/kernel_api.csv --cfg1-def-table ../../kernel/kernel_def.csv  --cfg1-def-table ../../arch/arm_gcc/am1808/chip_def.csv  --cfg1-def-table ../../arch/arm_gcc/common/core_def.csv --api-table ../../target/ev3_gcc/api/ev3api.csv tEV3Sample.cfg

if ! [ -f ldscript.ld ]; then \
	sed "s/kernel_mem3\.o/kernel_mem\.o/g" < cfg3_out.ld \
														> ldscript.ld; \
fi
arm-none-eabi-gcc -std=gnu99 -D_GNU_SOURCE -Dgcc -Dam1808 -DDMA_MODE -mcpu=arm926ej-s -mlittle-endian -DUSE_CFG_PASS3 -g -Wall -O2 -DBUILD_EV3_PLATFORM -DOMIT_INITIALIZE_SECTIONS -DCONFIG_FB_DEFERRED_IO -D__KERNEL__ -D__TARGET_ARCH_ARM=5 -I. -I./gen -I../../tecs_kernel -I../../include -I../../arch -I../.. -I../../target/ev3_gcc/api/src -I../../../mruby/include -I../../tecs_lib/mindstorms_ev3 -I../../tecs_lib/common -I../../tecsgen/tecsgen/tecs -I../../tecsgen/tecsgen/tecs/mruby -I../../tecsgen/tecsgen/tecs/TLSFMalloc -I../../tecsgen/tecsgen/tecs/posix -I../../tecs_lib/mindstorms_ev3/balancer  -I../../target/ev3_gcc/drivers -I../../modules/btstack/platforms/ev3rt -I../../target/ev3_gcc/drivers/soc//AM1808_StarterWare_1_00_03_03/include/hw -I../../modules/usblib/usblib/include -I../../target/ev3_gcc -I../../target/ev3_gcc/api/include -I../../target/ev3_gcc/dmloader/app/include -I../../target/ev3_gcc/dmloader/include -I../../target/ev3_gcc/drivers/bluetooth/btstack/include -I../../target/ev3_gcc/drivers/bluetooth/include -I../../target/ev3_gcc/drivers/brick/include -I../../target/ev3_gcc/drivers/common/include -I../../target/ev3_gcc/drivers/common/virtual-linux-kernel/arch/arm/include -I../../target/ev3_gcc/drivers/common/virtual-linux-kernel/include -I../../target/ev3_gcc/drivers/console/include -I../../target/ev3_gcc/drivers/fatfs/include -I../../target/ev3_gcc/drivers/gpio/include -I../../target/ev3_gcc/drivers/lcd/include -I../../target/ev3_gcc/drivers/lcd/linux/include -I../../target/ev3_gcc/drivers/linux/arch/arm/include -I../../target/ev3_gcc/drivers/linux/arch/arm/mach-davinci/include -I../../target/ev3_gcc/drivers/linux/include -I../../target/ev3_gcc/drivers/mbed/include -I../../target/ev3_gcc/drivers/motor/include -I../../target/ev3_gcc/drivers/newlib/include -I../../target/ev3_gcc/drivers/sensor/analog/include -I../../target/ev3_gcc/drivers/sensor/i2c/include -I../../target/ev3_gcc/drivers/sensor/uart/d_uart/Linuxmod_AM1808/pru-firmware-05-31-2011-1423-v3.0/pru/hal/common/include -I../../target/ev3_gcc/drivers/sensor/uart/d_uart/Linuxmod_AM1808/pru-firmware-05-31-2011-1423-v3.0/pru/hal/uart/include -I../../target/ev3_gcc/drivers/sensor/uart/include -I../../target/ev3_gcc/drivers/soc/AM1808_StarterWare_1_00_03_03/include -I../../target/ev3_gcc/drivers/soc/include -I../../target/ev3_gcc/drivers/sound/include -I../../target/ev3_gcc/drivers/usbmsc/include -I../../target/ev3_gcc/kernel_mod/include -I../../target/ev3_gcc/pil/include -I../../target/ev3_gcc/platform/include -I../../target/ev3_gcc/TLSF-2.4.6/include -I../../arch/arm_gcc/am1808 -I../../arch/arm_gcc/common -I../../arch/gcc -I../../target/ev3_gcc/api -I../../target/ev3_gcc/drivers/fatfs/ff10b/src -I./../common -I. -I./zmodem/include -L../../modules/btstack/platforms/ev3rt -L../../modules/usblib/Release -mcpu=arm926ej-s -nostdlib -mlittle-endian -L ../../../mruby/build/ARM/lib/ -Wl,-Ttext,0xC0008000 -Wl,-Tdata,0xC0108000 -T ldscript.ld -o hrp2 start.o \
		 ev3main.o tlsf.o target_serial_dbsio.o driver_debug.o ev3_hacks.o hires_cyclic.o hires_alarm.o bluetooth_dri.o brick_dri.o ev3cyclic_dri.o console_dri.o console_menu.o fatfs_dri.o diskio.o fatfs_syscall.o ff.o mmcsd.o mmcsdlib.o mmcsd_dri.o mmcsd_proto.o mmcsd_rw.o unicode.o gpio_dri.o lcd_dri.o lcd_font.o lcd_spi.o newlib_dri.o analog_dri.o uart_dri.o pru.o suart_utils.o suart_api.o pru_suart.o i2c_dri.o davinci_iic_dri.o soc_cache.o soc_edma.o soc_interrupt.o edma.o uart.o cp15.o psc.o spi.o usb.o usbphyGS60.o cppi41dma.o evmAM1808_usb.o sound_dri.o motor_dri.o usbmsc_dri.o usbmsc_media_functions.o usb_dev_msc.o usb_msc_structs.o driver_interface_brick.o driver_interface_bluetooth.o driver_interface_filesys.o driver_interface_sound.o ev3exception.o ev3rt_config.o minIni.o ev3api.o ev3api_cfg.o ev3api_battery.o ev3api_brick.o ev3api_fs.o ev3api_speaker.o ev3api_lcd.o ev3api_motor.o ev3api_newlib.o ev3api_sensor.o vasyslog.o tTask_rDomainEV3_tecsgen.o tKernel_rDomainEV3_tecsgen.o tTLSFMalloc_rDomainEV3_tecsgen.o tUltrasonicSensor_rDomainEV3_tecsgen.o tColorSensor_rDomainEV3_tecsgen.o tTouchSensor_rDomainEV3_tecsgen.o tGyroSensor_rDomainEV3_tecsgen.o tMotor_rDomainEV3_tecsgen.o tButton_rDomainEV3_tecsgen.o tLCD_rDomainEV3_tecsgen.o tLED_rDomainEV3_tecsgen.o tBattery_rDomainEV3_tecsgen.o tSpeaker_rDomainEV3_tecsgen.o tEV3Platform_rDomainEV3_tecsgen.o tBalancer_rDomainEV3_tecsgen.o tSharedMemory_rDomainEV3_tecsgen.o tRunApp_rDomainEV3_tecsgen.o nMruby_tMrubyVM_rDomainEV3_tecsgen.o nMruby_tMrubyTaskBody_rDomainEV3_tecsgen.o  nMruby_tTECSInitializer_tecsgen.o nMruby_tCharPointer_tecsgen.o nMruby_tInt8Pointer_tecsgen.o nMruby_tInt32Pointer_tecsgen.o nMruby_tUInt16Pointer_tecsgen.o nMruby_tIntPointer_tecsgen.o nMruby_tULongPointer_tecsgen.o   nMruby_tsKernel_rDomainEV3_tecsgen.o nMruby_tsMotor_rDomainEV3_tecsgen.o nMruby_tsLCD_rDomainEV3_tecsgen.o nMruby_tsLED_rDomainEV3_tecsgen.o nMruby_tsButton_rDomainEV3_tecsgen.o nMruby_tsBattery_rDomainEV3_tecsgen.o nMruby_tsSpeaker_rDomainEV3_tecsgen.o nMruby_tsUltrasonicSensor_rDomainEV3_tecsgen.o nMruby_tsGyroSensor_rDomainEV3_tecsgen.o nMruby_tsColorSensor_rDomainEV3_tecsgen.o nMruby_tsTouchSensor_rDomainEV3_tecsgen.o nMruby_tsBalancer_rDomainEV3_tecsgen.o nMruby_tsSharedMemory_rDomainEV3_tecsgen.o nMruby_tsRunApp_rDomainEV3_tecsgen.o nMruby_tsKernel.o nMruby_tsMotor.o nMruby_tsLCD.o nMruby_tsLED.o nMruby_tsButton.o nMruby_tsBattery.o nMruby_tsSpeaker.o nMruby_tsUltrasonicSensor.o nMruby_tsGyroSensor.o nMruby_tsColorSensor.o nMruby_tsTouchSensor.o nMruby_tsBalancer.o nMruby_tsSharedMemory.o nMruby_tsRunApp.o  nMruby_tsKernel_Initializer_tecsgen.o nMruby_tsMotor_Initializer_tecsgen.o nMruby_tsLCD_Initializer_tecsgen.o nMruby_tsLED_Initializer_tecsgen.o nMruby_tsButton_Initializer_tecsgen.o nMruby_tsBattery_Initializer_tecsgen.o nMruby_tsSpeaker_Initializer_tecsgen.o nMruby_tsUltrasonicSensor_Initializer_tecsgen.o nMruby_tsGyroSensor_Initializer_tecsgen.o nMruby_tsColorSensor_Initializer_tecsgen.o nMruby_tsTouchSensor_Initializer_tecsgen.o nMruby_tsBalancer_Initializer_tecsgen.o nMruby_tsSharedMemory_Initializer_tecsgen.o nMruby_tsRunApp_Initializer_tecsgen.o nMruby_tsKernel_Initializer.o nMruby_tsMotor_Initializer.o nMruby_tsLCD_Initializer.o nMruby_tsLED_Initializer.o nMruby_tsButton_Initializer.o nMruby_tsBattery_Initializer.o nMruby_tsSpeaker_Initializer.o nMruby_tsUltrasonicSensor_Initializer.o nMruby_tsGyroSensor_Initializer.o nMruby_tsColorSensor_Initializer.o nMruby_tsTouchSensor_Initializer.o nMruby_tsBalancer_Initializer.o nMruby_tsSharedMemory_Initializer.o nMruby_tsRunApp_Initializer.o   tTask.o tUltrasonicSensor.o tColorSensor.o tTouchSensor.o tGyroSensor.o tMotor.o tButton.o tLCD.o tLED.o tBattery.o tSpeaker.o tEV3Platform.o tBalancer.o tSharedMemory.o tRunApp.o nMruby_tMrubyVM.o nMruby_tMrubyTaskBody.o  nMruby_tTECSInitializer.o nMruby_tCharPointer.o nMruby_tInt8Pointer.o nMruby_tInt32Pointer.o nMruby_tUInt16Pointer.o nMruby_tIntPointer.o nMruby_tULongPointer.o   balancer.o balancer_param.o rDomainEV3_Mruby_MrubyVM_mrb.o tecs_init.o log_output.o t_perror.o strerror.o   ../../../mruby/build/ARM/lib/libmruby.a -lm  serial_mod.o tl16c550.o banner.o syslog.o serial.o logtask.o   kernel_cfg.o kernel_mem.o  -lBTstack -lusblib   libkernel.a -lc -lm -lgcc  
arm-none-eabi-nm -n hrp2 > hrp2.syms
# diff cfg3_out.syms hrp2.syms
arm-none-eabi-objcopy -O binary -S hrp2 hrp2.bin
../../../bin/mkimage.exe -A arm -O linux -T kernel -C none -a 0xc0008000 -e 0xc0008000 -n "hrp2 kernel" -d hrp2.bin uImage
Image Name:   hrp2 kernel
Created:      Wed Jan 09 11:08:16 2019
Image Type:   ARM Linux Kernel Image (uncompressed)
Data Size:    1130544 Bytes = 1104.05 kB = 1.08 MB
Load Address: c0008000
Entry Point:  c0008000
chmod +x uImage
cp uImage /cygdrive/d/
